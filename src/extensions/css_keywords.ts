// Copyright 2022 Im-Beast. All rights reserved. MIT license.
import {
  buildCrayon,
  Crayon,
  GetMapKeys,
  mapPrototypeStyles,
  rgb,
  StyleCode,
} from "../../mod.ts";

const baseCssColors = new Map(
  [
    ["aliceBlue", (bg: boolean) => rgb(240, 248, 255, bg)],
    ["antiqueWhite", (bg: boolean) => rgb(250, 235, 215, bg)],
    ["aqua", (bg: boolean) => rgb(0, 255, 255, bg)],
    ["aquamarine", (bg: boolean) => rgb(127, 255, 212, bg)],
    ["azure", (bg: boolean) => rgb(240, 255, 255, bg)],
    ["beige", (bg: boolean) => rgb(245, 245, 220, bg)],
    ["bisque", (bg: boolean) => rgb(255, 228, 196, bg)],
    ["blanchedalMond", (bg: boolean) => rgb(255, 235, 205, bg)],
    ["blueViolet", (bg: boolean) => rgb(138, 43, 226, bg)],
    ["brown", (bg: boolean) => rgb(165, 42, 42, bg)],
    ["burlyWood", (bg: boolean) => rgb(222, 184, 135, bg)],
    ["cadetBlue", (bg: boolean) => rgb(95, 158, 160, bg)],
    ["chartreuse", (bg: boolean) => rgb(127, 255, 0, bg)],
    ["chocolate", (bg: boolean) => rgb(210, 105, 30, bg)],
    ["coral", (bg: boolean) => rgb(255, 127, 80, bg)],
    ["cornFlowerBlue", (bg: boolean) => rgb(100, 149, 237, bg)],
    ["cornsilk", (bg: boolean) => rgb(255, 248, 220, bg)],
    ["crimson", (bg: boolean) => rgb(220, 20, 60, bg)],
    ["darkBlue", (bg: boolean) => rgb(0, 0, 139, bg)],
    ["darkCyan", (bg: boolean) => rgb(0, 139, 139, bg)],
    ["darkGoldenRod", (bg: boolean) => rgb(184, 134, 11, bg)],
    ["darkGreen", (bg: boolean) => rgb(0, 100, 0, bg)],
    ["darkGray", (bg: boolean) => rgb(169, 169, 169, bg)],
    ["darkGrey", (bg: boolean) => rgb(169, 169, 169, bg)],
    ["darkKhaki", (bg: boolean) => rgb(189, 183, 107, bg)],
    ["darkMagenta", (bg: boolean) => rgb(139, 0, 139, bg)],
    ["darkOliveGreen", (bg: boolean) => rgb(85, 107, 47, bg)],
    ["darkOrange", (bg: boolean) => rgb(255, 140, 0, bg)],
    ["darkOrchid", (bg: boolean) => rgb(153, 50, 204, bg)],
    ["darkRed", (bg: boolean) => rgb(139, 0, 0, bg)],
    ["darkSalmon", (bg: boolean) => rgb(233, 150, 122, bg)],
    ["darkSeaGreen", (bg: boolean) => rgb(143, 188, 143, bg)],
    ["darkSlateBlue", (bg: boolean) => rgb(72, 61, 139, bg)],
    ["darkSlateGray", (bg: boolean) => rgb(47, 79, 79, bg)],
    ["darkSlateGrey", (bg: boolean) => rgb(47, 79, 79, bg)],
    ["darkTurquoise", (bg: boolean) => rgb(0, 206, 209, bg)],
    ["darkViolet", (bg: boolean) => rgb(148, 0, 211, bg)],
    ["deepPink", (bg: boolean) => rgb(255, 20, 147, bg)],
    ["deepSkyBlue", (bg: boolean) => rgb(0, 191, 255, bg)],
    ["dimGray", (bg: boolean) => rgb(105, 105, 105, bg)],
    ["dimGrey", (bg: boolean) => rgb(105, 105, 105, bg)],
    ["dodgerBlue", (bg: boolean) => rgb(30, 144, 255, bg)],
    ["fireBrick", (bg: boolean) => rgb(178, 34, 34, bg)],
    ["floralWhite", (bg: boolean) => rgb(255, 250, 240, bg)],
    ["forestGreen", (bg: boolean) => rgb(34, 139, 34, bg)],
    ["fuchsia", (bg: boolean) => rgb(255, 0, 255, bg)],
    ["gainsboro", (bg: boolean) => rgb(220, 220, 220, bg)],
    ["ghostWhite", (bg: boolean) => rgb(248, 248, 255, bg)],
    ["goldenRod", (bg: boolean) => rgb(218, 165, 32, bg)],
    ["gold", (bg: boolean) => rgb(255, 215, 0, bg)],
    ["gray", (bg: boolean) => rgb(128, 128, 128, bg)],
    ["greenYellow", (bg: boolean) => rgb(173, 255, 47, bg)],
    ["grey", (bg: boolean) => rgb(128, 128, 128, bg)],
    ["honeyDew", (bg: boolean) => rgb(240, 255, 240, bg)],
    ["hotPink", (bg: boolean) => rgb(255, 105, 180, bg)],
    ["indianRed", (bg: boolean) => rgb(205, 92, 92, bg)],
    ["indigo", (bg: boolean) => rgb(75, 0, 130, bg)],
    ["ivory", (bg: boolean) => rgb(255, 255, 240, bg)],
    ["khaki", (bg: boolean) => rgb(240, 230, 140, bg)],
    ["lavenderBlush", (bg: boolean) => rgb(255, 240, 245, bg)],
    ["lavender", (bg: boolean) => rgb(230, 230, 250, bg)],
    ["lawnGreen", (bg: boolean) => rgb(124, 252, 0, bg)],
    ["lemonChiffon", (bg: boolean) => rgb(255, 250, 205, bg)],
    ["lightCoral", (bg: boolean) => rgb(240, 128, 128, bg)],
    ["lightGoldenRodYellow", (bg: boolean) => rgb(250, 250, 210, bg)],
    ["lightGray", (bg: boolean) => rgb(211, 211, 211, bg)],
    ["lightGrey", (bg: boolean) => rgb(211, 211, 211, bg)],
    ["lightPink", (bg: boolean) => rgb(255, 182, 193, bg)],
    ["lightSalmon", (bg: boolean) => rgb(255, 160, 122, bg)],
    ["lightSeaGreen", (bg: boolean) => rgb(32, 178, 170, bg)],
    ["lightSkyBlue", (bg: boolean) => rgb(135, 206, 250, bg)],
    ["lightSlateGray", (bg: boolean) => rgb(119, 136, 153, bg)],
    ["lightSlateGrey", (bg: boolean) => rgb(119, 136, 153, bg)],
    ["lightSteelBlue", (bg: boolean) => rgb(176, 196, 222, bg)],
    ["lime", (bg: boolean) => rgb(0, 255, 0, bg)],
    ["limeGreen", (bg: boolean) => rgb(50, 205, 50, bg)],
    ["linen", (bg: boolean) => rgb(250, 240, 230, bg)],
    ["maroon", (bg: boolean) => rgb(128, 0, 0, bg)],
    ["mediumAquamarine", (bg: boolean) => rgb(102, 205, 170, bg)],
    ["mediumBlue", (bg: boolean) => rgb(0, 0, 205, bg)],
    ["mediumOrchid", (bg: boolean) => rgb(186, 85, 211, bg)],
    ["mediumPurple", (bg: boolean) => rgb(147, 112, 219, bg)],
    ["mediumSeaGreen", (bg: boolean) => rgb(60, 179, 113, bg)],
    ["mediumSlateBlue", (bg: boolean) => rgb(123, 104, 238, bg)],
    ["mediumSpringGreen", (bg: boolean) => rgb(0, 250, 154, bg)],
    ["mediumTurquoise", (bg: boolean) => rgb(72, 209, 204, bg)],
    ["mediumVioletRed", (bg: boolean) => rgb(199, 21, 133, bg)],
    ["midnightBlue", (bg: boolean) => rgb(25, 25, 112, bg)],
    ["mintCream", (bg: boolean) => rgb(245, 255, 250, bg)],
    ["mistyrose", (bg: boolean) => rgb(255, 228, 225, bg)],
    ["moccasin", (bg: boolean) => rgb(255, 228, 181, bg)],
    ["navajoWhite", (bg: boolean) => rgb(255, 222, 173, bg)],
    ["navy", (bg: boolean) => rgb(0, 0, 128, bg)],
    ["oldLace", (bg: boolean) => rgb(253, 245, 230, bg)],
    ["olive", (bg: boolean) => rgb(128, 128, 0, bg)],
    ["olivedRab", (bg: boolean) => rgb(107, 142, 35, bg)],
    ["orange", (bg: boolean) => rgb(255, 165, 0, bg)],
    ["orangeRed", (bg: boolean) => rgb(255, 69, 0, bg)],
    ["orchid", (bg: boolean) => rgb(218, 112, 214, bg)],
    ["paleGoldenRod", (bg: boolean) => rgb(238, 232, 170, bg)],
    ["paleGreen", (bg: boolean) => rgb(152, 251, 152, bg)],
    ["paleTurquoise", (bg: boolean) => rgb(175, 238, 238, bg)],
    ["paleVioletRed", (bg: boolean) => rgb(219, 112, 147, bg)],
    ["papayaWhip", (bg: boolean) => rgb(255, 239, 213, bg)],
    ["peachPuff", (bg: boolean) => rgb(255, 218, 185, bg)],
    ["peru", (bg: boolean) => rgb(205, 133, 63, bg)],
    ["pink", (bg: boolean) => rgb(255, 192, 203, bg)],
    ["plum", (bg: boolean) => rgb(221, 160, 221, bg)],
    ["powderBlue", (bg: boolean) => rgb(176, 224, 230, bg)],
    ["purple", (bg: boolean) => rgb(128, 0, 128, bg)],
    ["rebeccaPurple", (bg: boolean) => rgb(102, 51, 153, bg)],
    ["rosyBrown", (bg: boolean) => rgb(188, 143, 143, bg)],
    ["royalBlue", (bg: boolean) => rgb(65, 105, 225, bg)],
    ["saddleBrown", (bg: boolean) => rgb(139, 69, 19, bg)],
    ["salmon", (bg: boolean) => rgb(250, 128, 114, bg)],
    ["sandyBrown", (bg: boolean) => rgb(244, 164, 96, bg)],
    ["seaGreen", (bg: boolean) => rgb(46, 139, 87, bg)],
    ["seaShell", (bg: boolean) => rgb(255, 245, 238, bg)],
    ["sienna", (bg: boolean) => rgb(160, 82, 45, bg)],
    ["silver", (bg: boolean) => rgb(192, 192, 192, bg)],
    ["skyBlue", (bg: boolean) => rgb(135, 206, 235, bg)],
    ["slateBlue", (bg: boolean) => rgb(106, 90, 205, bg)],
    ["slateGray", (bg: boolean) => rgb(112, 128, 144, bg)],
    ["slateGrey", (bg: boolean) => rgb(112, 128, 144, bg)],
    ["snow", (bg: boolean) => rgb(255, 250, 250, bg)],
    ["springGreen", (bg: boolean) => rgb(0, 255, 127, bg)],
    ["steelBlue", (bg: boolean) => rgb(70, 130, 180, bg)],
    ["tan", (bg: boolean) => rgb(210, 180, 140, bg)],
    ["teal", (bg: boolean) => rgb(0, 128, 128, bg)],
    ["thistle", (bg: boolean) => rgb(216, 191, 216, bg)],
    ["tomato", (bg: boolean) => rgb(255, 99, 71, bg)],
    ["turquoise", (bg: boolean) => rgb(64, 224, 208, bg)],
    ["violet", (bg: boolean) => rgb(238, 130, 238, bg)],
    ["wheat", (bg: boolean) => rgb(245, 222, 179, bg)],
    ["whiteSmoke", (bg: boolean) => rgb(245, 245, 245, bg)],
    ["yellowGreen", (bg: boolean) => rgb(154, 205, 50, bg)],
  ] as const,
);

/** All implemented css keywords */
export type CssKeywords =
  | GetMapKeys<typeof baseCssColors>
  | `bg${Capitalize<GetMapKeys<typeof baseCssColors>>}`;

/** Map containing CSS Color Keywords mapped to ANSI Escape Code which correspond to its color */
export const cssKeywords = new Map<CssKeywords, () => StyleCode>();

for (const [name, code] of baseCssColors.entries()) {
  cssKeywords.set(name, () => code(false));
  const bgName = `bg${name[0].toUpperCase() + name.slice(1)}` as CssKeywords;
  cssKeywords.set(bgName, () => code(true));
}

mapPrototypeStyles(cssKeywords);

/** Crayon type instance implementing all css keywords */
export type CssKeywordedCrayon = Crayon<CssKeywords>;

export const crayon = buildCrayon<CssKeywordedCrayon>();
